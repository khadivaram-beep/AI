import requests  # ฺฉุชุงุจุฎุงููโุง ุจุฑุง ูุฑุณุชุงุฏู ุฏุฑุฎูุงุณุช ุจู ุงูุชุฑูุช (ูุซู ุจุงุฒ ฺฉุฑุฏู ฺฉ ุณุงุช)
import time      # ุจุฑุง ุงุฌุงุฏ ูููู ู ุงุณุชุฑุงุญุช ุฏุงุฏู ุจู ุจุฑูุงูู

# ุชูฺฉู ุงุฎุชุตุงุต ุจุงุฒู ุดูุง ฺฉู ุงุฒ BotFather ุจูู ฺฏุฑูุชุฏ
TOKEN = "802549012:2SglERgmkafn0HTTh7w8fT304wREI_LUCFs"

# ุขุฏุฑุณ ุงุตู ุณุฑูุฑ ุจูู ุจุฑุง ุงุฑุชุจุงุท ุจุง ุจุงุฒู
BASE_URL = f"https://tapi.bale.ai/bot{TOKEN}/"

def main():
    # ฺุงูพ ฺฉ ูพุงู ุฏุฑ ูุญุท ูพุงุชูู ุจุฑุง ุงูฺฉู ุจูููู ุจุฑูุงูู ุดุฑูุน ุดุฏู
    print("๐ ุจุงุฒู ุฑูุดู ุดุฏ ู ููุชุธุฑ ุฏุฑุงูุช ูพุงู ุงุณุช...")
    
    last_update_id = None # ูุชุบุฑ ุจุฑุง ุฐุฎุฑู ุดูุงุฑู ุขุฎุฑู ูพุงู (ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชฺฉุฑุงุฑ)

    # ุดุฑูุน ฺฉ ุญููู ุจโุงูุชูุง (ุชุง ุฒูุงู ฺฉู ุจุฑูุงูู ุฑุง ุฎูุฏูุงู ูุจูุฏูุ ฺฉุงุฑ ูโฺฉูุฏ)
    while True:
        try:
            # ฑ. ุฏุฑุฎูุงุณุช ุจู ุจูู ุจุฑุง ฺฏุฑูุชู ูพุงูโูุง ุฌุฏุฏ
            url = f"{BASE_URL}getUpdates"
            params = {"offset": last_update_id, "timeout": 20}
            response = requests.get(url, params=params).json()

            # ฒ. ุจุฑุฑุณ ุงูฺฉู ุขุง ูพุงู ุฏุฑ ูุชุฌู (result) ูุฌูุฏ ุฏุงุฑุฏ ุง ุฎุฑ
            if "result" in response:
                for update in response["result"]:
                    # ุจุฑูุฒุฑุณุงู ุขุฏ ุจุฑุง ุงูฺฉู ูพุงู ุชฺฉุฑุงุฑ ูฺฏุฑู
                    last_update_id = update["update_id"] + 1
                    
                    # ณ. ุงุณุชุฎุฑุงุฌ ูุชู ูพุงู ู ุดูุงุฑู ฺุช (chat_id) ฺฉุงุฑุจุฑ
                    if "message" in update and "text" in update["message"]:
                        chat_id = update["message"]["chat"]["id"]
                        user_text = update["message"]["text"]
                        
                        # ฺุงูพ ูพุงู ุฏุฑุงูุช ุฏุฑ ูุญุท ูพุงุชูู (ุจุฑุง ฺฏุฒุงุฑุดโฺฏุฑ ูุง)
                        print(f"๐ฉ ูพุงู ุฌุฏุฏ: {user_text}")

                        # ด. ุณุงุฎุชู ูุชู ูพุงุณุฎ ู ุงุฑุณุงู ุขู ุจู ฺฉุงุฑุจุฑ ุฏุฑ ุจูู
                        reply_text = f"ุณูุงู! ูพุงู ุดูุง ('{user_text}') ุฏุฑุงูุช ุดุฏ ู ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด ุงุณุช."
                        send_url = f"{BASE_URL}sendMessage"
                        
                        # ุงุฑุณุงู ุฏุฑุฎูุงุณุช ููุง ุจู ุจูู ุจุฑุง ููุงุด ูพุงู ุจู ฺฉุงุฑุจุฑ
                        requests.post(send_url, json={"chat_id": chat_id, "text": reply_text})
        
        except Exception as e:
            # ุงฺฏุฑ ุงูุชุฑูุช ูุทุน ุดุฏ ุง ุฎุทุง ุฑุฎ ุฏุงุฏุ ุจุฑูุงูู ุจุณุชู ูุดูุฏ ู ููุท ุฎุทุง ุฑุง ฺุงูพ ฺฉูุฏ
            print(f"โ ุฎุทุง ุฑุฎ ุฏุงุฏ: {e}")
        
        # ฒ ุซุงูู ุตุจุฑ ูโฺฉูุฏ ู ุฏูุจุงุฑู ุงุฒ ุงูู ฺฺฉ ูโฺฉูุฏ (ุจุฑุง ุงูฺฉู ุณุฑูุฑ ุจูู ุฎุณุชู ูุดูุฏ!)
        time.sleep(2)

# ููุทู ุดุฑูุน ุงุฌุฑุง ุจุฑูุงูู
if __name__ == "__main__":
    main()
